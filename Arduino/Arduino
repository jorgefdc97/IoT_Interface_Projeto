/*
 * Pin layout:
 * --------------------------------
 *             MFRC522      Arduino
 * Signal      Pin          Pin
 * --------------------------------
 * RST/Reset   RST          9
 * SPI SS      SDA(SS)      10
 * SPI MOSI    MOSI         11
 * SPI MISO    MISO         12
 * SPI SCK     SCK          13
 * SDA
 * SCL
*/
//#include <IRremote.h>
#include <LiquidCrystal_I2C.h>
#include <dht.h>

const int FLAME_PIN = A0;
const int SENSOR_IR = A1;
const int SENSOR_TEMP = A2;

const int BUTTON_PIN = 4;
const int BLUE_LED_PIN = 5;
const int RED_LED_PIN = 6;
const int GREEN_LED_PIN = 7;
const int PIEZO_PIN = 8;

dht DHT;

LiquidCrystal_I2C lcd(0x27, 16, 2);



float lcd_timestamp;
float flame_value;


void setup(){
  Serial.begin(9600);

  //inputs

  //outputs
  pinMode(BLUE_LED_PIN, OUTPUT);
  pinMode(RED_LED_PIN, OUTPUT);
  pinMode(GREEN_LED_PIN, OUTPUT);
  pinMode(PIEZO_PIN, OUTPUT);

  pinMode(BUTTON_PIN, INPUT_PULLUP);
  pinMode(FLAME_PIN, INPUT);

  //lcd
  lcd.begin(16,2);
  lcd.init();
  lcd.backlight();

  //infra red
  //irrecv.enableIRIn();

} //end setup


void loop(){

  //temperature
  /*float input = analogRead(SENSOR_TEMP) * 5 / (1023.0);
  float celsius = (input) * 100;*/
  //VERSAO TINKERCAD
  float input = analogRead(SENSOR_TEMP) * 5000.0 / 1024.0;
  float celsius = (input - 500.0) / 10.0;

  if(millis() - lcd_timestamp > 5000){
    lcd.clear();
    lcd.setCursor(0,0);
    lcd.print(celsius);
    lcd.print(" Celsius");

    lcd_timestamp = millis();
  }

  flame_value = analogRead(FLAME_PIN);
  if(digitalRead(BUTTON_PIN) == LOW){
    digitalWrite(BLUE_LED_PIN, HIGH);
  }else{
    digitalWrite(BLUE_LED_PIN, LOW);
  }

  if(flame_value < 940){
    Serial.println(flame_value);
    digitalWrite(RED_LED_PIN, HIGH);
    digitalWrite(GREEN_LED_PIN, LOW);
    tone(PIEZO_PIN, 590, 2000);
  }else{
    Serial.println(flame_value);
    digitalWrite(RED_LED_PIN, LOW);
    digitalWrite(GREEN_LED_PIN, HIGH);
  }

}
